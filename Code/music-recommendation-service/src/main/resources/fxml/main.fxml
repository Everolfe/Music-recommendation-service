<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.scene.image.ImageView?>

<?import javafx.scene.control.cell.PropertyValueFactory?>
<VBox xmlns="http://javafx.com/javafx/17.0.2-ea"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.github.everolfe.controller.MainController"
      spacing="10"
      style="-fx-background-color: #ecf0f1;">

    <!-- ÐŸÐ°Ð½ÐµÐ»ÑŒ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ° -->
    <HBox spacing="20" style="-fx-background-color: #2c3e50; -fx-padding: 15;">
        <Label text="Music Recommendation Service"
               style="-fx-text-fill: white; -fx-font-size: 20px; -fx-font-weight: bold;"/>

        <HBox spacing="10" HBox.hgrow="ALWAYS" alignment="CENTER_RIGHT">
            <Label fx:id="userInfoLabel"
                   text="Ð“Ð¾ÑÑ‚ÑŒ"
                   style="-fx-text-fill: white; -fx-font-size: 14px;"/>
            <Button text="Ð’Ñ‹Ð¹Ñ‚Ð¸"
                    onAction="#handleLogout"
                    style="-fx-background-color: #e74c3c; -fx-text-fill: white;"/>
        </HBox>
    </HBox>

    <!-- ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ -->
    <TabPane fx:id="mainTabPane" VBox.vgrow="ALWAYS" tabClosingPolicy="UNAVAILABLE">

        <!-- Ð’ÐºÐ»Ð°Ð´ÐºÐ° Ð¿Ð¾Ð¸ÑÐºÐ° Ð¼ÑƒÐ·Ñ‹ÐºÐ¸ -->
        <Tab text="ðŸŽµ ÐŸÐ¾Ð¸ÑÐº Ð¼ÑƒÐ·Ñ‹ÐºÐ¸">
            <VBox spacing="15">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>

                <!-- âœ… ÐžÐ‘ÐÐžÐ’Ð›Ð•ÐÐž: ÐŸÐ°Ð½ÐµÐ»ÑŒ Ð¿Ð¾Ð¸ÑÐºÐ° Ñ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ð¼Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑÐ¼Ð¸ -->
                <VBox spacing="10">
                    <!-- ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ° Ð¿Ð¾Ð¸ÑÐºÐ° -->
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <TextField fx:id="searchField"
                                   promptText="ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ, Ð¸ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŽ..."
                                   HBox.hgrow="ALWAYS"/>
                        <Button text="Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº"
                                onAction="#handleSearch"
                                style="-fx-background-color: #3498db; -fx-text-fill: white;"/>
                        <Button fx:id="advancedSearchButton"
                                text="Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº"
                                onAction="#handleAdvancedSearch"
                                style="-fx-background-color: #9b59b6; -fx-text-fill: white;"/>
                    </HBox>

                    <!-- âœ… Ð”ÐžÐ‘ÐÐ’Ð›Ð•ÐÐž: ÐŸÐ°Ð½ÐµÐ»ÑŒ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð¸ÑÐºÐ° -->
                    <VBox spacing="8" style="-fx-padding: 10; -fx-background-color: #dfe6e9; -fx-background-radius: 5;">
                        <Label text="Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹:" style="-fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                        <!-- Ð’ Ð¿Ð°Ð½ÐµÐ»ÑŒ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð¸ÑÐºÐ° Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼: -->
                        <HBox spacing="15" alignment="CENTER_LEFT">
                            <VBox spacing="5">
                                <Label text="ÐÑ€Ñ‚Ð¸ÑÑ‚:" style="-fx-font-size: 12px;"/>
                                <TextField fx:id="artistFilterField" promptText="Ð»ÑŽÐ±Ð¾Ð¹ Ð°Ñ€Ñ‚Ð¸ÑÑ‚" prefWidth="120"/>
                            </VBox>

                            <VBox spacing="5">
                                <Label text="ÐÐ»ÑŒÐ±Ð¾Ð¼:" style="-fx-font-size: 12px;"/>
                                <TextField fx:id="albumFilterField" promptText="Ð»ÑŽÐ±Ð¾Ð¹ Ð°Ð»ÑŒÐ±Ð¾Ð¼" prefWidth="120"/>
                            </VBox>

                            <VBox spacing="5">
                                <Label text="Ð–Ð°Ð½Ñ€:" style="-fx-font-size: 12px;"/>
                                <TextField fx:id="genreFilterField" promptText="Ð»ÑŽÐ±Ð¾Ð¹ Ð¶Ð°Ð½Ñ€" prefWidth="100"/>
                            </VBox>

                            <VBox spacing="5">
                                <Label text="Ð“Ð¾Ð´ Ð¾Ñ‚:" style="-fx-font-size: 12px;"/>
                                <TextField fx:id="minYearField" promptText="1990" prefWidth="60"/>
                            </VBox>

                            <VBox spacing="5">
                                <Label text="Ð´Ð¾:" style="-fx-font-size: 12px;"/>
                                <TextField fx:id="maxYearField" promptText="2024" prefWidth="60"/>
                            </VBox>
                        </HBox>
                    </VBox>
                </VBox>

                <SplitPane dividerPositions="0.7" VBox.vgrow="ALWAYS">

                    <!-- Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ñ‚Ñ€ÐµÐºÐ¾Ð² -->
                    <VBox spacing="10">
                        <Label text="ÐÐ°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ðµ Ñ‚Ñ€ÐµÐºÐ¸:"
                               style="-fx-font-weight: bold; -fx-font-size: 14px;"/>

                        <TableView fx:id="tracksTable" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="trackTitleColumn" text="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" prefWidth="200"/>
                                <TableColumn fx:id="trackArtistColumn" text="Ð˜ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒ" prefWidth="150"/>
                                <TableColumn fx:id="trackAlbumColumn" text="ÐÐ»ÑŒÐ±Ð¾Ð¼" prefWidth="150"/>
                                <TableColumn fx:id="trackDurationColumn" text="Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ" prefWidth="100"/>
                                <TableColumn prefWidth="80" text="Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="source" />
                                    </cellValueFactory>
                                </TableColumn>
                            </columns>
                        </TableView>
                    </VBox>

                    <!-- Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ñ‚Ñ€ÐµÐºÐµ -->
                    <VBox spacing="15" style="-fx-padding: 15;">
                        <Label text="Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ñ‚Ñ€ÐµÐºÐµ"
                               style="-fx-font-weight: bold; -fx-font-size: 16px;"/>

                        <!-- âœ… Ð˜Ð—ÐœÐ•ÐÐ•ÐÐž: Ð Ð°ÑÐ¿Ð¾Ð»Ð°Ð³Ð°ÐµÐ¼ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¸ Ð¾Ð±Ð»Ð¾Ð¶ÐºÑƒ Ð³Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»ÑŒÐ½Ð¾ -->
                        <HBox spacing="20" alignment="TOP_LEFT">
                            <!-- Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ñ‚Ñ€ÐµÐºÐµ -->
                            <VBox spacing="15" prefWidth="250">
                                <VBox spacing="10">
                                    <Label text="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ:" style="-fx-font-weight: bold;"/>
                                    <Label fx:id="trackInfoTitle" text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‚Ñ€ÐµÐº" wrapText="true"/>
                                </VBox>

                                <VBox spacing="10">
                                    <Label text="Ð˜ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒ:" style="-fx-font-weight: bold;"/>
                                    <Label fx:id="trackInfoArtist" text="" wrapText="true"/>
                                </VBox>

                                <VBox spacing="10">
                                    <Label text="ÐÐ»ÑŒÐ±Ð¾Ð¼:" style="-fx-font-weight: bold;"/>
                                    <Label fx:id="trackInfoAlbum" text="" wrapText="true"/>
                                </VBox>

                                <VBox spacing="10">
                                    <Label text="Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ:" style="-fx-font-weight: bold;"/>
                                    <Label fx:id="trackInfoDuration" text=""/>
                                </VBox>

                                <VBox spacing="10">
                                    <Label text="Ð–Ð°Ð½Ñ€:" style="-fx-font-weight: bold;"/>
                                    <Label fx:id="trackInfoGenre" text="" wrapText="true"/>
                                </VBox>
                            </VBox>

                            <!-- âœ… ÐŸÐ•Ð Ð•ÐœÐ•Ð©Ð•ÐÐž: ÐžÐ±Ð»Ð¾Ð¶ÐºÐ° Ð°Ð»ÑŒÐ±Ð¾Ð¼Ð° ÑÐ¿Ñ€Ð°Ð²Ð° -->
                            <VBox spacing="8" style="-fx-padding: 10; -fx-background-color: #bdc3c7; -fx-background-radius: 5;">
                                <Label text="ÐžÐ±Ð»Ð¾Ð¶ÐºÐ° Ð°Ð»ÑŒÐ±Ð¾Ð¼Ð°:" style="-fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                                <ImageView fx:id="albumCoverImage"
                                           fitWidth="180"
                                           fitHeight="180"
                                           preserveRatio="true"
                                           style="-fx-border-color: #7f8c8d; -fx-border-width: 1; -fx-border-radius: 3;"/>
                                <Label fx:id="albumInfoLabel"
                                       text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‚Ñ€ÐµÐº Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ð¾Ð±Ð»Ð¾Ð¶ÐºÐ¸"
                                       style="-fx-text-fill: #34495e; -fx-font-size: 11px; -fx-alignment: CENTER;"
                                       wrapText="true"/>
                            </VBox>
                        </HBox>

                        <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ -->
                        <VBox spacing="10" style="-fx-padding: 10 0 0 0;">
                            <!-- Ð’Ñ‹Ð±Ð¾Ñ€ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³Ð° Ð¿ÐµÑ€ÐµÐ´ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼ -->
                            <VBox spacing="5">
                                <Label fx:id="ratingLabel" text="ÐžÑ†ÐµÐ½ÐºÐ°: 3"/>
                                <Slider fx:id="ratingSlider"
                                        min="1" max="5" value="3"
                                        showTickLabels="true" showTickMarks="true"
                                        majorTickUnit="1" snapToTicks="true"/>
                            </VBox>

                            <Button fx:id="addToCollectionButton"
                                    text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑŽ Ñ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð¹ Ð¾Ñ†ÐµÐ½ÐºÐ¾Ð¹"
                                    onAction="#handleAddToCollection"
                                    style="-fx-background-color: #27ae60; -fx-text-fill: white;"
                                    prefWidth="250"/>
                        </VBox>
                    </VBox>
                </SplitPane>
            </VBox>
        </Tab>

        <!-- Ð’ÐºÐ»Ð°Ð´ÐºÐ° Ð¼Ð¾ÐµÐ¹ ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸ -->
        <Tab text="â­ ÐœÐ¾Ñ ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ñ">
            <VBox spacing="15">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>

                <Label text="ÐœÐ¾Ñ Ð¼ÑƒÐ·Ñ‹ÐºÐ°Ð»ÑŒÐ½Ð°Ñ ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ñ"
                       style="-fx-font-weight: bold; -fx-font-size: 16px;"/>

                <TableView fx:id="collectionTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn text="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" prefWidth="200">
                            <cellValueFactory>
                                <PropertyValueFactory property="title" />
                            </cellValueFactory>
                        </TableColumn>
                        <TableColumn text="Ð˜ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒ" prefWidth="150">
                            <cellValueFactory>
                                <PropertyValueFactory property="artistName" />
                            </cellValueFactory>
                        </TableColumn>
                        <TableColumn text="ÐžÑ†ÐµÐ½ÐºÐ°" prefWidth="100">
                            <cellValueFactory>
                                <PropertyValueFactory property="rating" />
                            </cellValueFactory>
                        </TableColumn>
                    </columns>
                </TableView>

                <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÐµÐ¹ -->
                <HBox spacing="10" style="-fx-padding: 10 0 0 0;">
                    <VBox spacing="5">
                        <Label text="Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¾Ñ†ÐµÐ½ÐºÑƒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ñ‚Ñ€ÐµÐºÐ°:" style="-fx-font-weight: bold;"/>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Slider fx:id="ratingSliderCollection"
                                    min="1" max="5" value="3"
                                    showTickLabels="true" showTickMarks="true"
                                    majorTickUnit="1" snapToTicks="true"
                                    prefWidth="150"/>
                            <Label fx:id="ratingLabelCollection" text="3"/>
                            <Button fx:id="updateRatingInCollectionButton"
                                    text="ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³"
                                    onAction="#handleUpdateRatingInCollection"
                                    style="-fx-background-color: #3498db; -fx-text-fill: white;"/>
                        </HBox>
                    </VBox>

                    <Button fx:id="removeFromCollectionButton"
                            text="ðŸ—‘ï¸ Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð¸Ð· ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸"
                            onAction="#handleRemoveFromCollection"
                            style="-fx-background-color: #e74c3c; -fx-text-fill: white;"
                            HBox.hgrow="NEVER"/>
                </HBox>
            </VBox>
        </Tab>

        <!-- Ð’ÐºÐ»Ð°Ð´ÐºÐ° Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹ -->
        <Tab text="ðŸŽ¯ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸">
            <VBox spacing="10">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>

                <!-- ÐŸÐ°Ð½ÐµÐ»ÑŒ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸ÑÐ¼Ð¸ -->
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Button fx:id="refreshRecommendationsButton"
                            text="ðŸ”„ Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ"
                            onAction="#handleRefreshRecommendations"
                            style="-fx-background-color: #9b59b6; -fx-text-fill: white;"/>

                    <Button fx:id="markAsViewedButton"
                            text="âœ… ÐžÑ‚Ð¼ÐµÑ‚Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ð½Ð¾Ð¹"
                            onAction="#handleMarkAsViewed"
                            disable="true"
                            style="-fx-background-color: #95a5a6; -fx-text-fill: white;"/>

                    <Button fx:id="addRecommendedToCollectionButton"
                            text="âž• Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑŽ"
                            onAction="#handleAddRecommendedToCollection"
                            disable="true"
                            style="-fx-background-color: #27ae60; -fx-text-fill: white;"/>
                </HBox>

                <!-- Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹ -->
                <Label text="ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸:"
                       style="-fx-font-weight: bold; -fx-font-size: 14px;"/>

                <TableView fx:id="recommendationsTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="recTrackColumn" text="Ð¢Ñ€ÐµÐº" prefWidth="200"/>
                        <TableColumn fx:id="recArtistColumn" text="Ð˜ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒ" prefWidth="150"/>
                        <TableColumn fx:id="recTypeColumn" text="Ð¢Ð¸Ð¿ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸" prefWidth="150"/>
                        <TableColumn fx:id="recScoreColumn" text="Ð£Ð²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ" prefWidth="120"/>
                    </columns>
                </TableView>

                <!-- ÐŸÐ¾Ð´ÑÐºÐ°Ð·ÐºÐ° -->
                <Label text="ðŸ’¡ Ð¡Ð¾Ð²ÐµÑ‚: Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐ¹Ñ‚Ðµ Ð±Ð¾Ð»ÑŒÑˆÐµ Ñ‚Ñ€ÐµÐºÐ¾Ð² Ð² ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑŽ Ð´Ð»Ñ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹"
                       style="-fx-text-fill: #7f8c8d; -fx-font-size: 12px;"/>
            </VBox>
        </Tab>
    </TabPane>
</VBox>